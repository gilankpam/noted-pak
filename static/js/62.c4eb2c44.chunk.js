(()=>{"use strict";var e={62:(e,s,t)=>{var a=t(9379),o=t(9397);class r{static async getInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.instancePromise||(this.instancePromise=this.loadResources(e)),this.instancePromise}static async loadResources(e){return this.tokenizer=await o.v6I.from_pretrained(this.model_id,{progress_callback:e}),this.processor=await o.oye.from_pretrained(this.model_id,{progress_callback:e}),this.model=await o.EAC.from_pretrained(this.model_id,{dtype:{encoder_model:"fp32",decoder_model_merged:"q4"},device:"webgpu",progress_callback:e}),[this.tokenizer,this.processor,this.model]}}r.model_id="onnx-community/whisper-base",r.tokenizer=null,r.processor=null,r.model=null,r.instancePromise=null;let n=!1;self.addEventListener("message",(async e=>{const{type:s,data:t}=e.data;switch(s){case"load":await async function(){self.postMessage({status:"loading",data:"Loading model components..."});try{const[,e,s]=await r.getInstance((e=>{self.postMessage(e)}));self.postMessage({status:"loading",data:"Compiling shaders and warming up model..."});const t=new Float32Array(16e3),a=await e(t,{sampling_rate:16e3});await s.generate({input_features:a.input_features,max_new_tokens:1}),self.postMessage({status:"ready"})}catch(e){self.postMessage({status:"error",error:"Model load/warmup failed: ".concat(e.message),stack:e.stack})}}();break;case"generate":await async function(e){let{audio:s,language:t}=e;if(n)self.postMessage({status:"busy",error:"Processor is busy."});else{n=!0,self.postMessage({status:"start"});try{const[e,n,i]=await r.getInstance();if(!e||!n||!i)throw new Error("Model components not loaded.");let l,c=0,p=0;const d=()=>{var e;null!==(e=l)&&void 0!==e||(l=performance.now()),c++,c>1&&l&&(p=c/(performance.now()-l)*1e3)},u=e=>{self.postMessage({status:"update",output:e,tps:p,numTokens:c})},f=new o.T1P(e,{skip_prompt:!0,skip_special_tokens:!0,callback_function:u,token_callback_function:d}),m=await n(s,{sampling_rate:16e3});await i.generate((0,a.A)((0,a.A)({},m),{},{max_new_tokens:64,language:t||"en",streamer:f})),self.postMessage({status:"complete"})}catch(i){self.postMessage({status:"error",error:i.message,stack:i.stack})}finally{n=!1}}}(t);break;default:console.warn("Worker received unknown message type: ".concat(s))}}))}},s={};function t(a){var o=s[a];if(void 0!==o)return o.exports;var r=s[a]={exports:{}};return e[a](r,r.exports,t),r.exports}t.m=e,t.x=()=>{var e=t.O(void 0,[827,778],(()=>t(62)));return e=t.O(e)},(()=>{var e=[];t.O=(s,a,o,r)=>{if(!a){var n=1/0;for(p=0;p<e.length;p++){a=e[p][0],o=e[p][1],r=e[p][2];for(var i=!0,l=0;l<a.length;l++)(!1&r||n>=r)&&Object.keys(t.O).every((e=>t.O[e](a[l])))?a.splice(l--,1):(i=!1,r<n&&(n=r));if(i){e.splice(p--,1);var c=o();void 0!==c&&(s=c)}}return s}r=r||0;for(var p=e.length;p>0&&e[p-1][2]>r;p--)e[p]=e[p-1];e[p]=[a,o,r]}})(),t.d=(e,s)=>{for(var a in s)t.o(s,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:s[a]})},t.f={},t.e=e=>Promise.all(Object.keys(t.f).reduce(((s,a)=>(t.f[a](e,s),s)),[])),t.u=e=>"static/js/"+e+"."+{778:"bf74655f",827:"b0032c7c"}[e]+".chunk.js",t.miniCssF=e=>{},t.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),t.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.p="/noted-pak/",(()=>{t.b=self.location+"/../../../";var e={62:1};t.f.i=(s,a)=>{e[s]||importScripts(t.p+t.u(s))};var s=self.webpackChunknoted_pak=self.webpackChunknoted_pak||[],a=s.push.bind(s);s.push=s=>{var o=s[0],r=s[1],n=s[2];for(var i in r)t.o(r,i)&&(t.m[i]=r[i]);for(n&&n(t);o.length;)e[o.pop()]=1;a(s)}})(),(()=>{var e=t.x;t.x=()=>Promise.all([t.e(827),t.e(778)]).then(e)})();t.x()})();
//# sourceMappingURL=62.c4eb2c44.chunk.js.map