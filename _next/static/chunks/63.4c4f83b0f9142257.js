(()=>{var e={9063:(e,t,r)=>{"use strict";var s=r(1430);s._K2.allowLocalModels=!1;let a={whisper_base_f32:{label:"Whisper Base f32 (Heavier)",model_id:"onnx-community/whisper-base",params:{dtype:{encoder_model:"fp32",decoder_model_merged:"fp32"}}},whisper_base_q4:{label:"Whisper Base q4 (Lighter)",model_id:"onnx-community/whisper-base",params:{dtype:{encoder_model:"q4",decoder_model_merged:"q4"}}}};class o{static getInstance(){if(!this.tokenizer||!this.processor||!this.model)throw Error("Model is not loaded");return[this.tokenizer,this.processor,this.model]}static async loadModel(e,t){if(t===this.currentModel)return[this.tokenizer,this.processor,this.model];let r=this.defaultModel;t&&(r=a[t]),this.currentModel=r.name;let o=r.model_id;return console.log("Loading resources for ".concat(o," with params:"),r.params),this.tokenizer=await s.v6I.from_pretrained(o,{progress_callback:e}),this.processor=await s.oye.from_pretrained(o,{progress_callback:e}),this.model=await s.EAC.from_pretrained(o,{...r.params,device:"webgpu",progress_callback:e}),console.log("Model loaded successfully:",o),this.currentModel=t,[this.tokenizer,this.processor,this.model]}}o.model_id=null,o.tokenizer=null,o.processor=null,o.model=null,o.currentModel=null,o.defaultModel=a.whisper_base_q4;let n=!1;async function i(e){let{audio:t,language:r="en"}=e;if(n)return void self.postMessage({status:"busy",error:"Processor is busy."});n=!0,self.postMessage({status:"start"});try{let[e,a,n]=o.getInstance(),i=new s.T1P(e,{skip_prompt:!0,skip_special_tokens:!0,callback_function:e=>{self.postMessage({status:"update",output:e})}}),l=await a(t,{sampling_rate:16e3});await n.generate({...l,max_new_tokens:512,language:r||"en",streamer:i}),self.postMessage({status:"complete"})}catch(e){self.postMessage({status:"error",error:e.message,stack:e.stack})}finally{n=!1}}async function l(){let{modelName:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;self.postMessage({status:"loading"});try{let[,t,r]=await o.loadModel(e=>self.postMessage(e),e);self.postMessage({status:"loading",data:"Compiling shaders and warming up model..."});let s=new Float32Array(16e3),a=await t(s,{sampling_rate:16e3});await r.generate({input_features:a.input_features,max_new_tokens:1}),self.postMessage({status:"ready"})}catch(e){self.postMessage({status:"error",error:"Model load/warmup failed: ".concat(e.message),stack:e.stack})}}self.addEventListener("message",async e=>{let{type:t,data:r}=e.data;switch(t){case"load":await l({...r});break;case"generate":await i({...r});break;default:console.warn("Worker received unknown message type: ".concat(t))}})}},t={};function r(s){var a=t[s];if(void 0!==a)return a.exports;var o=t[s]={exports:{}},n=!0;try{e[s](o,o.exports,r),n=!1}finally{n&&delete t[s]}return o.exports}r.m=e,r.x=()=>{var e=r.O(void 0,[803,643,699],()=>r(9063));return r.O(e)},(()=>{var e=[];r.O=(t,s,a,o)=>{if(s){o=o||0;for(var n=e.length;n>0&&e[n-1][2]>o;n--)e[n]=e[n-1];e[n]=[s,a,o];return}for(var i=1/0,n=0;n<e.length;n++){for(var[s,a,o]=e[n],l=!0,d=0;d<s.length;d++)(!1&o||i>=o)&&Object.keys(r.O).every(e=>r.O[e](s[d]))?s.splice(d--,1):(l=!1,o<i&&(i=o));if(l){e.splice(n--,1);var c=a();void 0!==c&&(t=c)}}return t}})(),r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce((t,s)=>(r.f[s](e,t),t),[])),r.u=e=>"static/chunks/"+(({643:"037f3a08",803:"adda3502"})[e]||e)+"."+({643:"b3a221f1a03a90d7",699:"4db0c599526b17b2",803:"eba37b97483c5080"})[e]+".js",r.miniCssF=e=>{},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.U=function(e){var t=new URL(e,"x:/"),r={};for(var s in t)r[s]=t[s];for(var s in r.href=e,r.pathname=e.replace(/[?#].*/,""),r.origin=r.protocol="",r.toString=r.toJSON=()=>e,r)Object.defineProperty(this,s,{enumerable:!0,configurable:!0,value:r[s]})},r.U.prototype=URL.prototype,(()=>{var e;r.tt=()=>(void 0===e&&(e={createScriptURL:e=>e},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(e=trustedTypes.createPolicy("nextjs#bundler",e))),e)})(),r.tu=e=>r.tt().createScriptURL(e),r.p="/_next/",(()=>{var e={63:1};r.f.i=(t,s)=>{e[t]||importScripts(r.tu(r.p+r.u(t)))};var t=self.webpackChunk_N_E=self.webpackChunk_N_E||[],s=t.push.bind(t);t.push=t=>{var[a,o,n]=t;for(var i in o)r.o(o,i)&&(r.m[i]=o[i]);for(n&&n(r);a.length;)e[a.pop()]=1;s(t)}})(),(()=>{var e=r.x;r.x=()=>Promise.all([803,643,699].map(r.e,r)).then(e)})(),_N_E=r.x()})();